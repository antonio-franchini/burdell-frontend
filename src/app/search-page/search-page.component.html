<br>

<h1>Vehicles list</h1>
<form [formGroup]="form" (ngSubmit)="searchVehicles()">
  <div class="mt-5">

      <mat-form-field>
        <mat-select placeholder="Filter by status" formControlName="status" name="status">
          <mat-option *ngFor="let status of statuses" [value]="status">{{status}}</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field>
          <input matInput placeholder="Filter by keyword" type="text" class="form-control" formControlName="keyword">
      </mat-form-field>

    <div>
      <button type="submit" class="btn btn-primary">Apply filters</button>
      <a routerLink="/purchased-vehicle-form"><button type="submit" class="btn btn-primary"
          *ngIf="stateService.permissionMatches('inventory clerk')">Add Vehicle</button></a>

      <a routerLink="/reports-page"><button type="submit" class="btn btn-primary"
          *ngIf="stateService.permissionMatches('manager')">View Reports</button></a>
    </div>

  </div>


  <br>
  <br>


  <h3 *ngIf="vehicles.length > 0">Vehicles</h3>
  <div>
    <table mat-table [dataSource]="vehicles" class="mat-elevation-z8" *ngIf="vehicles.length > 0">

      <ng-container matColumnDef="parent1">
        <th class="filterRow" *matHeaderCellDef colspan="1">
          <mat-form-field class="filterContent">
            <input matInput placeholder="Filter" type="text" class="form-control" formControlName="vin">
          </mat-form-field>
        </th>
      </ng-container>

      <ng-container matColumnDef="parent2">
        <th class="filterRow" *matHeaderCellDef colspan="1">
          <mat-form-field>
            <mat-select placeholder="Type" formControlName="type" name="type">
              <mat-option *ngFor="let vehicleType of vehicleTypes" [value]="vehicleType.type">
                {{vehicleType.type}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </th>
      </ng-container>

      <ng-container matColumnDef="parent3">
        <th class="filterRow" *matHeaderCellDef colspan="1">
          <mat-form-field>
            <mat-select placeholder="Make" formControlName="make" name="make">
              <mat-option *ngFor="let vehicleMake of vehicleMakes" [value]="vehicleMake.make">
                {{vehicleMake.make}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </th>
      </ng-container>

      <ng-container matColumnDef="parent4">
        <th class="filterRow" *matHeaderCellDef colspan="1">
          <mat-form-field class="filterContent">
            <input matInput placeholder="Filter" type="text" class="form-control" formControlName="model">
          </mat-form-field>
        </th>
      </ng-container>

      <ng-container matColumnDef="parent5">
        <th class="filterRow" *matHeaderCellDef colspan="1">
          <mat-form-field class="filterContent">
            <input matInput placeholder="Filter" type="text" class="form-control" formControlName="year">
          </mat-form-field>
        </th>
      </ng-container>

      <ng-container matColumnDef="parent6">
        <th class="filterRow" *matHeaderCellDef colspan="1">
          <mat-form-field class="filterRowWrapper">
            <mat-select placeholder="Filter" formControlName="colors" name="colors">
              <mat-option *ngFor="let color of colors" [value]="color.color">
                {{color.color}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </th>
      </ng-container>

      <ng-container matColumnDef="parent7">
        <th class="filterRow" *matHeaderCellDef colspan="1"></th>
      </ng-container>

      <ng-container matColumnDef="parent8">
        <th class="filterRow" *matHeaderCellDef colspan="1"></th>
      </ng-container>


      <!-- COLUMN INFO -->
      <!--vin Col -->
      <ng-container matColumnDef="vin">
        <th mat-header-cell *matHeaderCellDef>VIN</th>
        <td mat-cell *matCellDef="let item"> {{item.vin}} </td>
      </ng-container>

      <!--type Col -->
      <ng-container matColumnDef="type">
        <th mat-header-cell *matHeaderCellDef>Type</th>
        <td mat-cell *matCellDef="let item">{{item.type}} </td>
      </ng-container>

      <!--make Col -->
      <ng-container matColumnDef="make">
        <th mat-header-cell *matHeaderCellDef>Make</th>
        <td mat-cell *matCellDef="let item">{{item.make}} </td>
      </ng-container>

      <!--model Col -->
      <ng-container matColumnDef="model">
        <th mat-header-cell *matHeaderCellDef>Model</th>
        <td mat-cell *matCellDef="let item">{{item.model}} </td>
      </ng-container>

      <!--year Col -->
      <ng-container matColumnDef="year">
        <th mat-header-cell *matHeaderCellDef>year</th>
        <td mat-cell *matCellDef="let item">{{item.year}} </td>
      </ng-container>

      <!--colors Col -->
      <ng-container matColumnDef="colors">
        <th mat-header-cell *matHeaderCellDef>Colors</th>
        <td mat-cell *matCellDef="let item">{{item.colors}} </td>
      </ng-container>

      <!--mileage Col -->
      <ng-container matColumnDef="mileage">
        <th mat-header-cell *matHeaderCellDef>Mileage</th>
        <td mat-cell *matCellDef="let item">{{item.mileage}} </td>
      </ng-container>

      <!--price Col -->
      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef>Price</th>
        <td mat-cell *matCellDef="let item">{{item.purchasePrice}} </td>
      </ng-container>

      <!-- ROW Info-->
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>

      <tr class="filterRow" mat-header-row *matHeaderRowDef="[
    'parent1',
    'parent2',
    'parent3',
    'parent4',
    'parent5',
    'parent6',
    'parent7',
    'parent8'
  ]"></tr>

      <tr class="btn-item" mat-row *matRowDef="let rowData; columns: displayedColumns;"
        [ngClass]="{'highlight': selectedRowIndex == rowData.id}" (click)="viewDetails(rowData)"></tr>

    </table>
  </div>

  <h4 *ngIf="vehicles.length == 0">Sorry, it looks like we donâ€™t have that in stock!</h4>
  <br>
  <br>

</form>